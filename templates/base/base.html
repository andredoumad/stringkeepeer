{% load static %}

<!doctype html>
<html lang="en">

  <head>
      <!-- Required meta tags -->
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      {% include 'base/css.html' %}
      <title>{% block title %} Hello {% endblock %}</title>
  </head>

  {% include 'base/navbar.html' %}
  <body style="background-color:rgb(61, 70, 78);">
    
    <div class='container'>
        <!-- <div class='row'> -->
          <!-- <div class='col-12'> -->

            {% block content %}
            {% endblock %}

            {% include 'base/js.html' %}

            <script>
              $(document).ready(function(){
                var subscriptionForm = $(".form-subscription-ajax")

                subscriptionForm.submit(function(event){
                  event.preventDefault();
                  console.log('Form is not sending')
                  var thisForm = $(this)
                  var actionEndpoint = thisForm.attr('action');
                  var httpMethod = thisForm.attr('method');
                  var formData = thisForm.serialize();

                  $.ajax({
                      url: actionEndpoint,
                      method: httpMethod,
                      data: formData,
                      success: function(data){
                        console.log('success')
                        console.log(data)
                        console.log('Added: ', data.added)
                        console.log('Removed: ', data.removed)
                        var submitSpan = thisForm.find('.submit-span')
                        if (data.added){
                          submitSpan.html("In cart <button type='submit' class='btn btn-link'>Remove</button>")
                        }else{
                          submitSpan.html("Add to cart <button type='submit' class='btn btn-success'>Add</button>")
                        }
                        var navbarCount = $(".navbar-cart-count")
                        navbarCount.text(data.cartItemCount)

                      },
                      error: function(errorData){
                        console.log('error')
                        console.log(errorData)
                      }
                  })
                })
              })
            
            </script>

            <footer class="container">
                {% if ascii_art %}
                <pre>
                  <p style="font-size:2px">
                  <font color = '#85C1E9'> {{ascii_art}}
                </pre>
                {% endif %}
            </footer>
        <!-- </div> -->
      <!-- </div> -->
    </div>

  </body>
</html>
